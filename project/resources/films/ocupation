SELECT
        (concat('MATCH ('
		,'p:Person {id:"'
		,REPLACE(str(?director), 'http://www.wikidata.org/entity/', '')
		,'"}) SET '
		,'p.occupation = '
		,concat('["', group_concat(?occupationLabel; separator='","'),'"]')
		,' RETURN p') as ?InsertOccupationIntoNodePerson)
		#,' RETURN p;') as ?InsertOccupationIntoNodePerson)					#Para una línea
 WHERE
{
        SELECT
				DISTINCT
                ?director ?directorLabel ?dateOfBirth ?occupationLabel
         WHERE 
        {
                # Film
                ?film				wdt:P31 			wd:Q11424 .
                ?film				rdfs:label 			?filmLabel .
                # Actor
                # wd:Q43416 -> Keanu Reeves
                ?film				wdt:P161			wd:Q43416 .
                wd:Q43416			rdfs:label			?actorLabel .
                ?film 				wdt:P57				?director .
                ?director			rdfs:label			?directorLabel .
                ?director			wdt:P569			?dateOfBirth .
			optional {
          		?director			wdt:P106			?occupation .
                ?occupation			rdfs:label			?occupationLabel .
                FILTER (lang(?occupationLabel) = "en") .
			}
          		FILTER (lang(?filmLabel) = "en") .
                FILTER (lang(?directorLabel) = "en") .
        }
        #GROUP BY ?director ?directorLabel ?dateOfBirth ?occupationLabel
}
GROUP BY ?director ?directorLabel ?dateOfBirth
ORDER BY ?directorLabel